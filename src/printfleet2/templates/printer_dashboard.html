{% extends "base.html" %}

{% block title %}PrintFleet2 | Printer Dashboard{% endblock %}

{% block content %}
  <section class="hero">
    <div class="container hero-grid">
      <div class="hero-copy">
        <p class="eyebrow">PrintFleet2</p>
        <h1>Printer Dashboard</h1>
        <p class="lead">Live status and energy at a glance.</p>
      </div>
      <div class="hero-card reveal" style="animation-delay: 0.1s">
        <h3>Live snapshot</h3>
        <div class="metric">
          <span class="metric-label">Printers</span>
          <span class="metric-value" id="printerCount">{{ snapshot.total_printers if snapshot else "--" }}</span>
        </div>
        <div class="metric">
          <span class="metric-label">Active prints</span>
          <span class="metric-value" id="activePrintsCount">{{ snapshot.active_prints if snapshot else "--" }}</span>
        </div>
        <div class="metric">
          <span class="metric-label">Active errors</span>
          <span class="metric-value" id="activeErrorsCount">{{ snapshot.active_errors if snapshot else "--" }}</span>
        </div>
        <div class="metric">
          <span class="metric-label">Power (W)</span>
          <span class="metric-value" id="totalPowerNow">--</span>
        </div>
        <div class="metric">
          <span class="metric-label">Today (kWh)</span>
          <span class="metric-value" id="totalEnergyToday">--</span>
        </div>
      </div>
    </div>
  </section>

  <section class="container">
    <article class="card reveal" style="animation-delay: 0.2s">
      <div class="table-header">
        <div>
          <h3>Active printers</h3>
          <p class="muted">Status, temps, and jobs from system config.</p>
        </div>
      </div>
      <div class="table-wrap">
        <table class="data-table">
          <thead>
            <tr>
              <th><button class="sort-button" type="button" data-sort="name"><span>Name</span><span class="sort-icon" aria-hidden="true"></span></button></th>
              <th><button class="sort-button" type="button" data-sort="status"><span>Status</span><span class="sort-icon" aria-hidden="true"></span></button></th>
              <th><button class="sort-button" type="button" data-sort="temp_now"><span>Temp now</span><span class="sort-icon" aria-hidden="true"></span></button></th>
              <th><button class="sort-button" type="button" data-sort="target_temp"><span>Target temp</span><span class="sort-icon" aria-hidden="true"></span></button></th>
              <th><button class="sort-button" type="button" data-sort="job"><span>Job</span><span class="sort-icon" aria-hidden="true"></span></button></th>
              <th><button class="sort-button" type="button" data-sort="elapsed"><span>Elapsed</span><span class="sort-icon" aria-hidden="true"></span></button></th>
              <th><button class="sort-button" type="button" data-sort="remaining"><span>Remaining</span><span class="sort-icon" aria-hidden="true"></span></button></th>
              <th>Links</th>
            </tr>
          </thead>
          <tbody id="printerDashboardTable">
            <tr>
              <td colspan="8" class="muted">No active printers yet.</td>
            </tr>
          </tbody>
        </table>
      </div>
    </article>
  </section>
{% endblock %}

{% block scripts %}
  <script src="{{ url_for('static', filename='printer_dashboard.js') }}" defer></script>
{% endblock %}
